task C {
  int votes = 0;
  int n = P.size();
  boolean result = false;

  input init() {
    send vote_request() to P;
  }

  input vote(boolean commit) {
    if (!commit) {
      send abort() to P;
      result = false;
    } else {
      vote++;
      if (votes == n) {
        send commit() to P;
        result = true;
      }
    }
  }
}
